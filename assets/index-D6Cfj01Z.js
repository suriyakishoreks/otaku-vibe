import{j as i,r as b,C as L,v as E}from"./default-vendor-BUfURK-0.js";import{i as H,L as x,C as I,S as N,l as U,m as K,n as $,g as F}from"./index-BEG4dcT7.js";import{I as V,a as B}from"./ImageCard-D7_f-nno.js";import{e as z}from"./utility-vendor-Dwq46G1b.js";import{a as j,f as P}from"./util-CtyiVqhm.js";import"./motion-core-CUQz13Lg.js";const Q="_dropdown_1htwn_158",W="_dropdown__header_1htwn_163",J="_dropdown__text_1htwn_183",Z="_dropdown__list_1htwn_206",y={dropdown:Q,dropdown__header:W,dropdown__text:J,"dropdown__down-chevron":"_dropdown__down-chevron_1htwn_192","dropdown__clear-btn":"_dropdown__clear-btn_1htwn_195",dropdown__list:Z,"dropdown__list-item":"_dropdown__list-item_1htwn_221","dropdown__list-item--selected":"_dropdown__list-item--selected_1htwn_227"};function X({size:s,color:a,className:r}){return i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,height:s,viewBox:"0 -960 960 960",width:s,transform:"rotate(90)",fill:H(a),children:i.jsx("path",{d:"m321-80-71-71 329-329-329-329 71-71 400 400L321-80Z"})})}const Y=(s,a)=>{b.useEffect(()=>{const r=l=>{const t=s==null?void 0:s.current;!t||t.contains((l==null?void 0:l.target)||null)||a(l)};return document.addEventListener("mousedown",r),document.addEventListener("touchstart",r),()=>{document.removeEventListener("mousedown",r),document.removeEventListener("touchstart",r)}},[s,a])};function R({options:s,selectedOptions:a,onSelect:r,placeholder:l,isMulti:t=!1,onClear:d,defaultOption:p}){const[o,h]=b.useState(!1),S=b.useRef(null);Y(S,()=>{o&&h(!1)}),b.useEffect(()=>{if(a.length===0&&p){const e=s.find(n=>n.id===p);e&&r(e)}},[a,p,r,s]);const _=e=>{r(e),t||h(!1)},m=e=>{e.stopPropagation(),e.preventDefault(),d==null||d()},f=e=>a.some(n=>n.id===e.id),w=`${l||""}${l&&a.length>0?": ":""}${a.length>0?a.reduce((e,n,u)=>u===0?n.title:e+", "+n.title,""):""}`;return i.jsxs("div",{className:y.dropdown,ref:S,children:[i.jsxs("div",{className:y.dropdown__header,onClick:()=>h(!o),children:[i.jsx(x,{as:"p",font:"typo-primary-m-medium",className:y.dropdown__text,children:w}),!!d&&a.length>0&&i.jsx("button",{className:y["dropdown__clear-btn"],onClick:m,children:i.jsx(I,{size:16,color:"s-color-fg-primary"})}),i.jsx(X,{size:20,color:"s-color-fg-primary",className:y["dropdown__down-chevron"]})]}),o&&i.jsx("ul",{className:y.dropdown__list,children:s.map(e=>i.jsx("li",{className:`${y["dropdown__list-item"]} ${f(e)?y["dropdown__list-item--selected"]:""}`,onClick:()=>_(e),children:e.title},e.id))})]})}const ee="_search_rp7so_158",te="_search__category_rp7so_172",ie="_search__bar_rp7so_191",ae="_search__button_rp7so_214",v={search:ee,"search__top-container":"_search__top-container_rp7so_161",search__category:te,search__bar:ie,"search__bottom-container":"_search__bottom-container_rp7so_208","search__button-container":"_search__button-container_rp7so_214",search__button:ae},q=[{title:"Action",id:"1"},{title:"Adventure",id:"2"},{title:"Avant Garde",id:"5"},{title:"Award Winning",id:"46"},{title:"Boys Love",id:"28"},{title:"Comedy",id:"4"},{title:"Drama",id:"8"},{title:"Fantasy",id:"10"},{title:"Girls Love",id:"26"},{title:"Gourmet",id:"47"},{title:"Horror",id:"14"},{title:"Mystery",id:"7"},{title:"Romance",id:"22"},{title:"Sci-Fi",id:"24"},{title:"Slice of Life",id:"36"},{title:"Sports",id:"30"},{title:"Supernatural",id:"37"},{title:"Suspense",id:"41"},{title:"Ecchi",id:"9",nsfw:!0},{title:"Erotica",id:"49",nsfw:!0},{title:"Hentai",id:"12",nsfw:!0},{title:"Adult Cast",id:"50"},{title:"Anthropomorphic",id:"51"},{title:"CGDCT",id:"52"},{title:"Childcare",id:"53"},{title:"Combat Sports",id:"54"},{title:"Crossdressing",id:"81"},{title:"Delinquents",id:"55"},{title:"Detective",id:"39"},{title:"Educational",id:"56"},{title:"Gag Humor",id:"57"},{title:"Gore",id:"58"},{title:"Harem",id:"35"},{title:"High Stakes Game",id:"59"},{title:"Historical",id:"13"},{title:"Idols (Female)",id:"60"},{title:"Idols (Male)",id:"61"},{title:"Isekai",id:"62"},{title:"Iyashikei",id:"63"},{title:"Love Polygon",id:"64"},{title:"Magical Sex Shift",id:"65"},{title:"Mahou Shoujo",id:"66"},{title:"Martial Arts",id:"17"},{title:"Mecha",id:"18"},{title:"Medical",id:"67"},{title:"Military",id:"38"},{title:"Music",id:"19"},{title:"Mythology",id:"6"},{title:"Organized Crime",id:"68"},{title:"Otaku Culture",id:"69"},{title:"Parody",id:"20"},{title:"Performing Arts",id:"70"},{title:"Pets",id:"71"},{title:"Psychological",id:"40"},{title:"Racing",id:"3"},{title:"Reincarnation",id:"72"},{title:"Reverse Harem",id:"73"},{title:"Love Status Quo",id:"74"},{title:"Samurai",id:"21"},{title:"School",id:"23"},{title:"Showbiz",id:"75"},{title:"Space",id:"29"},{title:"Strategy Game",id:"11"},{title:"Super Power",id:"31"},{title:"Survival",id:"76"},{title:"Team Sports",id:"77"},{title:"Time Travel",id:"78"},{title:"Vampire",id:"32"},{title:"Video Game",id:"79"},{title:"Visual Arts",id:"80"},{title:"Workplace",id:"48"},{title:"Urban Fantasy",id:"82"},{title:"Villainess",id:"83"},{title:"Josei",id:"43"},{title:"Kids",id:"15"},{title:"Seinen",id:"42"},{title:"Shoujo",id:"25"},{title:"Shounen",id:"27"}],D=[{id:"1",title:"Action"},{id:"2",title:"Adventure"},{id:"5",title:"Avant Garde"},{id:"46",title:"Award Winning"},{id:"28",title:"Boys Love"},{id:"4",title:"Comedy"},{id:"8",title:"Drama"},{id:"10",title:"Fantasy"},{id:"26",title:"Girls Love"},{id:"47",title:"Gourmet"},{id:"14",title:"Horror"},{id:"7",title:"Mystery"},{id:"22",title:"Romance"},{id:"24",title:"Sci-Fi"},{id:"36",title:"Slice of Life"},{id:"30",title:"Sports"},{id:"37",title:"Supernatural"},{id:"45",title:"Suspense"},{id:"9",title:"Ecchi"},{id:"49",title:"Erotica"},{id:"12",title:"Hentai"},{id:"50",title:"Adult Cast"},{id:"51",title:"Anthropomorphic"},{id:"52",title:"CGDCT"},{id:"53",title:"Childcare"},{id:"54",title:"Combat Sports"},{id:"44",title:"Crossdressing"},{id:"55",title:"Delinquents"},{id:"39",title:"Detective"},{id:"56",title:"Educational"},{id:"57",title:"Gag Humor"},{id:"58",title:"Gore"},{id:"35",title:"Harem"},{id:"59",title:"High Stakes Game"},{id:"13",title:"Historical"},{id:"60",title:"Idols (Female)"},{id:"61",title:"Idols (Male)"},{id:"62",title:"Isekai"},{id:"63",title:"Iyashikei"},{id:"64",title:"Love Polygon"},{id:"65",title:"Magical Sex Shift"},{id:"66",title:"Mahou Shoujo"},{id:"17",title:"Martial Arts"},{id:"18",title:"Mecha"},{id:"67",title:"Medical"},{id:"68",title:"Memoir"},{id:"38",title:"Military"},{id:"19",title:"Music"},{id:"6",title:"Mythology"},{id:"69",title:"Organized Crime"},{id:"70",title:"Otaku Culture"},{id:"20",title:"Parody"},{id:"71",title:"Performing Arts"},{id:"72",title:"Pets"},{id:"40",title:"Psychological"},{id:"3",title:"Racing"},{id:"73",title:"Reincarnation"},{id:"74",title:"Reverse Harem"},{id:"75",title:"Love Status Quo"},{id:"21",title:"Samurai"},{id:"23",title:"School"},{id:"76",title:"Showbiz"},{id:"29",title:"Space"},{id:"11",title:"Strategy Game"},{id:"31",title:"Super Power"},{id:"77",title:"Survival"},{id:"78",title:"Team Sports"},{id:"79",title:"Time Travel"},{id:"32",title:"Vampire"},{id:"80",title:"Video Game"},{id:"81",title:"Villainess"},{id:"82",title:"Visual Arts"},{id:"48",title:"Workplace"},{id:"83",title:"Urban Fantasy"},{id:"42",title:"Josei"},{id:"15",title:"Kids"},{id:"41",title:"Seinen"},{id:"25",title:"Shoujo"},{id:"27",title:"Shounen"}],re=[{id:"tv",title:"TV"},{id:"movie",title:"Movie"},{id:"ova",title:"OVA"},{id:"special",title:"Special"},{id:"ona",title:"ONA"},{id:"music",title:"Music"},{id:"cm",title:"CM"},{id:"pv",title:"PV"},{id:"tv_special",title:"TV Special"}],le=[{id:"airing",title:"Airing"},{id:"complete",title:"Complete"},{id:"upcoming",title:"Upcoming"}],se=[{id:"g",title:"G - All Ages"},{id:"pg",title:"PG - Children"},{id:"pg13",title:"PG-13 - Teens 13 or Older"},{id:"r17",title:"R - 17+ (violence & profanity)"},{id:"r",title:"R+ - Mild Nudity"},{id:"rx",title:"Rx - Hentai"}],oe=[{id:"mal_id",title:"MAL ID"},{id:"title",title:"Title"},{id:"start_date",title:"Start Date"},{id:"end_date",title:"End Date"},{id:"episodes",title:"Episodes"},{id:"score",title:"Score"},{id:"scored_by",title:"Scored By"},{id:"rank",title:"Rank"},{id:"popularity",title:"Popularity"},{id:"members",title:"Members"},{id:"favorites",title:"Favorites"}],C=[{id:"desc",title:"Descending"},{id:"asc",title:"Ascending"}],de=[{id:"manga",title:"Manga"},{id:"novel",title:"Novel"},{id:"lightnovel",title:"Light Novel"},{id:"oneshot",title:"Oneshot"},{id:"doujin",title:"Doujinshi"},{id:"manhwa",title:"Manhwa"},{id:"manhua",title:"Manhua"}],ne=[{id:"publishing",title:"Publishing"},{id:"complete",title:"Complete"},{id:"hiatus",title:"Hiatus"},{id:"discontinued",title:"Discontinued"},{id:"upcoming",title:"Upcoming"}],ce=[{id:"mal_id",title:"MAL ID"},{id:"title",title:"Title"},{id:"start_date",title:"Start Date"},{id:"end_date",title:"End Date"},{id:"chapters",title:"Chapters"},{id:"volumes",title:"Volumes"},{id:"score",title:"Score"},{id:"scored_by",title:"Scored By"},{id:"rank",title:"Rank"},{id:"popularity",title:"Popularity"},{id:"members",title:"Members"},{id:"favorites",title:"Favorites"}],ue=[{id:"mal_id",title:"MAL ID"},{id:"name",title:"Name"},{id:"birthday",title:"Birthday"},{id:"favorites",title:"Favorites"}],pe=[{id:"mal_id",title:"MAL ID"},{id:"name",title:"Name"},{id:"favorites",title:"Favorites"}],T=[{id:"anime",title:"Anime"},{id:"manga",title:"Manga"},{id:"people",title:"People"},{id:"characters",title:"Characters"}];function me({options:s,searchQueryKey:a,searchCategory:r}){const[l,t]=L(),d=E(),[p,o]=b.useState(new URLSearchParams(l));b.useEffect(()=>{o(new URLSearchParams(l))},[l]);const h=(e,n)=>{o(u=>{var G;const c=new URLSearchParams(u),g=((G=c.get(e))==null?void 0:G.split(","))??[],A=g.includes(n.id)?g.filter(O=>O!==n.id):[...g,n.id];return A.length?c.set(e,A.join(",")):c.delete(e),c.set("page","1"),c})},S=(e,n)=>{o(u=>{const c=new URLSearchParams(u);return n.id?c.set(e,n.id):c.delete(e),c.set("page","1"),c})},_=e=>{const n=e.target.value;o(u=>{const c=new URLSearchParams(u);return n?c.set(a,n):c.delete(a),c.set("page","1"),c})},m=e=>{d.pathname==="/search"&&t(n=>{const u=new URLSearchParams;u.set("category",(e==null?void 0:e.id)??r);const c=n.get(a)??p.get(a);return c&&u.set(a,c),u.set("page","1"),u},{replace:!0})},f=e=>{o(n=>{const u=new URLSearchParams(n);return u.delete(e),u.set("page","1"),u})},w=()=>{d.pathname==="/search"&&t(new URLSearchParams(p),{replace:!0})};return i.jsxs("div",{className:v.search,children:[i.jsxs("div",{className:v["search__top-container"],children:[i.jsx("div",{className:v.search__category,children:i.jsx(R,{options:T,selectedOptions:T.filter(e=>e.id===l.get("category")),onSelect:m,defaultOption:r})}),i.jsxs("div",{className:v.search__bar,children:[i.jsx(N,{size:20,color:"s-color-fg-primary"}),i.jsx("input",{type:"text",placeholder:"Find what you're looking for...",value:p.get(a)??"",onChange:_,className:"typo-primary-m-medium"})]})]}),i.jsx("div",{className:v["search__bottom-container"],children:s.map(e=>{var c;const n=((c=p.get(e.queryKey))==null?void 0:c.split(","))??[],u=e.options.filter(g=>n.includes(g.id));return i.jsx(R,{placeholder:e.placeholder,options:e.options,selectedOptions:u,onSelect:g=>e.type==="multi"?h(e.queryKey,g):S(e.queryKey,g),isMulti:e.type==="multi",defaultOption:e.default,onClear:e.default?void 0:()=>f(e.queryKey)},e.queryKey)})}),i.jsx("div",{className:v["search__button-container"],children:i.jsxs("button",{onClick:w,className:v.search__button,children:[i.jsx(N,{size:24,color:"s-color-fg-primary"}),i.jsx(x,{as:"p",font:"typo-primary-l-medium",children:"Search"})]})})]})}const M={"search-result":"_search-result_5s4hf_158","search-result__grid":"_search-result__grid_5s4hf_161","search-result__pagination":"_search-result__pagination_5s4hf_183","no-result":"_no-result_5s4hf_213"};function k({useQueryHook:s,options:a,adapter:r}){const[l,t]=L(),{data:d,isFetching:p}=s(a),o=d?r(d):void 0,h=m=>{t(f=>{const w=new URLSearchParams(f);return w.set("page",m.toString()),w},{replace:!0})},S=()=>!o||!o.data||p?Array.from({length:25},(m,f)=>i.jsx(V,{grid:!0},f)):o.data.length===0?i.jsx(x,{as:"p",font:"typo-primary-xl-medium",className:M["no-result"],children:"No results found"}):o.data.map(m=>i.jsx(B,{navigateTo:m.navigateTo,src:m.imageUrl,alt:m.title,title:m.title,ratings:m.ratings,favorites:m.favorites,grid:!0},m.key)),_=Number(l.get("page")??"1");return i.jsxs("div",{className:M["search-result"],children:[i.jsx("div",{className:z(M["search-result__grid"]),children:S()}),(o==null?void 0:o.pagination)&&o.pagination.last_visible_page>1&&i.jsxs("div",{className:M["search-result__pagination"],children:[i.jsx("button",{onClick:()=>h(_-1),disabled:_===1,children:i.jsx(x,{as:"p",font:"typo-primary-m-semibold",children:"Previous"})}),i.jsxs(x,{as:"p",font:"typo-primary-m-medium",children:["Page ",_," of ",o.pagination.last_visible_page]}),i.jsx("button",{onClick:()=>h(_+1),disabled:!o.pagination.has_next_page,children:i.jsx(x,{as:"p",font:"typo-primary-m-semibold",children:"Next"})})]})]})}function he(s){switch(s){case"anime":return[{queryKey:"type",options:re,placeholder:"Type"},{queryKey:"rating",options:se,placeholder:"Rating"},{queryKey:"status",options:le,placeholder:"Status"},{queryKey:"genres",options:q,type:"multi",placeholder:"Genres"},{queryKey:"genres_exclude",options:q,type:"multi",placeholder:"Exclude Genres"},{queryKey:"order_by",options:oe,placeholder:"Order By"},{queryKey:"sort",options:C,placeholder:"Sort",default:"desc"}];case"manga":return[{queryKey:"type",options:de,placeholder:"Type"},{queryKey:"status",options:ne,placeholder:"Status"},{queryKey:"genres",options:D,type:"multi",placeholder:"Genres"},{queryKey:"genres_exclude",options:D,type:"multi",placeholder:"Exclude Genres"},{queryKey:"order_by",options:ce,placeholder:"Order By"},{queryKey:"sort",options:C,placeholder:"Sort",default:"desc"}];case"characters":return[{queryKey:"order_by",options:pe,placeholder:"Order By"},{queryKey:"sort",options:C,placeholder:"Sort",default:"desc"}];case"people":return[{queryKey:"order_by",options:ue,placeholder:"Order By"},{queryKey:"sort",options:C,placeholder:"Sort",default:"desc"}];default:return[]}}function _e(s,a){const r={q:a.get("q")??void 0,page:Number(a.get("page")??"1"),order_by:a.get("order_by")??void 0,sort:a.get("sort")??void 0};switch(s==="anime"&&(r.type=a.get("type")??void 0,r.rating=a.get("rating")??void 0,r.status=a.get("status")??void 0,r.genres=a.get("genres")??void 0,r.genres_exclude=a.get("genres_exclude")??void 0),s==="manga"&&(r.type=a.get("type")??void 0,r.status=a.get("status")??void 0,r.genres=a.get("genres")??void 0,r.genres_exclude=a.get("genres_exclude")??void 0),s){case"anime":return i.jsx(k,{useQueryHook:F,options:r,adapter:l=>({pagination:l.pagination,data:j(l.data.map(t=>{var d,p;return{key:`anime_${t.mal_id}`,title:((d=t.titles.find(o=>o.type==="Default"))==null?void 0:d.title)??t.title,imageUrl:t.images.jpg.image_url,navigateTo:`/anime/${t.mal_id}`,alt:t.title,ratings:(p=t.score)==null?void 0:p.toString(),favorites:P(t.favorites)}}),"key")})});case"manga":return i.jsx(k,{useQueryHook:$,options:r,adapter:l=>({pagination:l.pagination,data:j(l.data.map(t=>{var d,p;return{key:`manga_${t.mal_id}`,title:((d=t.titles.find(o=>o.type==="Default"))==null?void 0:d.title)??t.title,imageUrl:t.images.jpg.image_url,navigateTo:`/manga/${t.mal_id}`,alt:t.title,ratings:(p=t.score)==null?void 0:p.toString(),favorites:P(t.favorites)}}),"key")})});case"characters":return i.jsx(k,{useQueryHook:K,options:r,adapter:l=>({pagination:l.pagination,data:j(l.data.map(t=>{var d;return{key:`character_${t.mal_id}`,title:t.name,imageUrl:((d=t.images.webp)==null?void 0:d.image_url)??t.images.jpg.image_url,navigateTo:`/character/${t.mal_id}`,alt:t.name,favorites:P(t.favorites)}}),"key")})});case"people":return i.jsx(k,{useQueryHook:U,options:r,adapter:l=>({pagination:l.pagination,data:j(l.data.map(t=>{var d;return{key:`person_${t.mal_id}`,title:t.name,imageUrl:((d=t.images.webp)==null?void 0:d.image_url)??t.images.jpg.image_url,navigateTo:`/people/${t.mal_id}`,alt:t.name,favorites:P(t.favorites)}}),"key")})});default:return null}}function xe(){const[s]=L(),a=s.get("category")??"anime";return i.jsxs("div",{children:[i.jsx(me,{options:he(a),searchQueryKey:"q",searchCategory:a}),_e(a,s)]})}export{xe as default};
